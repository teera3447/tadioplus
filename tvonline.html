<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Tadio+ TV Online (Perfect UI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <link href="https://unpkg.com/@videojs/themes@1.0.1/dist/fantasy/index.css" rel="stylesheet">

    <style>
        :root { --bg: #0f172a; --panel: #020617; --accent: #38bdf8; --text: #f8fafc; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); overflow: hidden; }
        header { padding: 15px; background: var(--panel); text-align: center; border-bottom: 1px solid #1e293b; font-weight: bold; }
        #app { display: flex; height: calc(100vh - 56px); }
        #playerWrap { flex: 1; background: #000; position: relative; display: flex; flex-direction: column; }
        
        /* --- Video.js Perfect UI Customization --- */
        .video-js { width: 100% !important; height: 100% !important; }
        
        /* ‡∏à‡∏±‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞ LIVE ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô */
        .vjs-quality-selector {
            order: 2; /* ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° Play */
            margin-right: 15px !important;
        }

        /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô Quality ‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏á ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° HD ‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ */
        .vjs-quality-selector .vjs-menu-button-placeholder:before {
            content: "HD" !important;
            font-family: Arial, sans-serif !important;
            font-weight: 900;
            font-size: 14px !important;
            line-height: 3.2 !important; /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
            color: var(--accent);
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏° LIVE ‡πÉ‡∏´‡πâ‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
        .vjs-live-control {
            order: 3;
            margin-left: 5px !important;
            display: flex;
            align-items: center;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 1px;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Volume ‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤ */
        .vjs-volume-panel { order: 10; margin-left: auto !important; }
        .vjs-fullscreen-control { order: 11; }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
        .vjs-menu-content { background-color: #1e293b !important; border-radius: 4px; }
        .vjs-menu-item:hover { background-color: var(--accent) !important; color: #000 !important; }
        .vjs-menu-item.vjs-selected { background-color: #334155 !important; }

        #channels { width: 320px; background: var(--panel); display: flex; flex-direction: column; border-left: 1px solid #1e293b; }
        .search-box { padding: 15px; }
        input { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #334155; background: #1e293b; color: #fff; outline: none; box-sizing: border-box; }
        #list { flex: 1; overflow-y: auto; }
        .channel { padding: 12px; border-bottom: 1px solid #1e293b; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .channel:hover { background: #1e293b; }
        .channel.active { border-left: 4px solid var(--accent); background: #1e293b; }
        .channel img { width: 30px; height: 30px; object-fit: contain; background: #fff; border-radius: 4px; }
        .status-bar { padding: 8px 15px; background: #020617; font-size: 11px; color: #64748b; border-top: 1px solid #1e293b; }
        
        @media(max-width: 768px) { #app { flex-direction: column; } #channels { width: 100%; height: 45vh; } }
    </style>
</head>
<body>

<header>Tadio+ Premium TV</header>

<div id="app">
    <div id="playerWrap">
        <video id="my-video" class="video-js vjs-theme-fantasy" controls preload="auto" playsinline></video>
        <div class="status-bar" id="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...</div>
    </div>
    <div id="channels">
        <div class="search-box">
            <input type="text" id="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á..." oninput="filter()">
        </div>
        <div id="list"></div>
    </div>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script src="https://unpkg.com/videojs-contrib-quality-levels@4.1.0/dist/videojs-contrib-quality-levels.min.js"></script>
<script src="https://unpkg.com/videojs-hls-quality-selector@2.0.0/dist/videojs-hls-quality-selector.min.js"></script>

<script>
    const BASE_WORKER_URL = "https://iptv.tadioplus.workers.dev"; 
    const GITHUB_BACKUP = "https://raw.githubusercontent.com/teera3447/tadioplus/refs/heads/main/tadio1.m3u";

    let allChannels = [];
    const statusText = document.getElementById('status');
    let v_player;

    document.addEventListener('DOMContentLoaded', () => {
        v_player = videojs('my-video', {
            fluid: false,
            responsive: true,
            autoplay: false,
            controlBar: {
                // ‡∏£‡∏∞‡∏ö‡∏∏‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°
                children: [
                    'playToggle',
                    'qualitySelector',
                    'liveDisplay',
                    'progressControl', // ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
                    'volumePanel',
                    'fullscreenToggle',
                ],
            }
        });

        v_player.hlsQualitySelector({ displayCurrentQuality: true });
        loadM3U();
    });

    async function loadM3U() {
        let fetchUrl = `${BASE_WORKER_URL}/list`;
        try {
            statusText.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
            let response = await fetch(fetchUrl);
            const data = await response.text();
            parseM3U(data);
        } catch (error) {
            const res = await fetch(GITHUB_BACKUP);
            const text = await res.text();
            parseM3U(text);
        }
    }

    function parseM3U(data) {
        const lines = data.split('\n');
        const channels = [];
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF:')) {
                const info = lines[i];
                const url = lines[i + 1]?.trim();
                if (url && url.startsWith('http')) {
                    const name = info.split(',')[1] || "Unknown Channel";
                    const logoMatch = info.match(/tvg-logo="([^"]+)"/);
                    const logo = logoMatch ? logoMatch[1] : "";
                    channels.push({ name, url, logo });
                }
            }
        }
        allChannels = channels;
        render(allChannels);
        statusText.innerText = `Online: ${allChannels.length} Channels`;
    }

    function fixUrl(url) {
        if (url.includes('livedoomovies') || !url.startsWith('https://')) {
            return `${BASE_WORKER_URL}/?url=` + encodeURIComponent(url);
        }
        return url;
    }

    function play(ch, el) {
        const finalUrl = fixUrl(ch.url);
        document.querySelectorAll('.channel').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
        statusText.innerText = "Connecting to " + ch.name + "...";
        v_player.src({ src: finalUrl, type: 'application/x-mpegURL' });
        v_player.play();
    }

    function filter() {
        const txt = document.getElementById('search').value.toLowerCase();
        render(allChannels.filter(c => c.name.toLowerCase().includes(txt)));
    }

    function render(data) {
        const container = document.getElementById('list');
        container.innerHTML = "";
        data.forEach(ch => {
            const div = document.createElement('div');
            div.className = 'channel';
            const img = ch.logo ? `<img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/30x30?text=TV'">` : 'üì∫';
            div.innerHTML = `${img} <span>${ch.name}</span>`;
            div.onclick = () => play(ch, div);
            container.appendChild(div);
        });
    }
</script>
</body>
</html>
