<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Tadio+ ดูทีวีออนไลน์ (Full Version)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <style>
        :root {
            --bg-dark: #0f172a;
            --panel-dark: #020617;
            --accent: #38bdf8;
            --text-main: #fff;
            --text-dim: #94a3b8;
        }
        body {
            margin: 0;
            font-family: 'Segoe UI', 'Kanit', sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            overflow: hidden;
        }
        header {
            padding: 12px;
            background: var(--panel-dark);
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            border-bottom: 1px solid #1e293b;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #app {
            display: flex;
            height: calc(100vh - 56px);
        }
        #playerWrap {
            flex: 1;
            background: black;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        video {
            width: 100%;
            height: 100%;
            background: black;
            outline: none;
        }
        .controls {
            display: flex;
            gap: 12px;
            padding: 10px;
            background: var(--panel-dark);
            align-items: center;
            flex-wrap: wrap;
        }
        button, select, input {
            padding: 8px 12px;
            border: 1px solid #334155;
            border-radius: 6px;
            cursor: pointer;
            background: #1e293b;
            color: white;
            font-size: 14px;
        }
        input { cursor: text; width: 100%; box-sizing: border-box; }
        button:hover { background: #334155; border-color: var(--accent); }
        
        #channels {
            width: 320px;
            display: flex;
            flex-direction: column;
            background: var(--panel-dark);
            border-left: 1px solid #1e293b;
        }
        .search-box { padding: 10px; border-bottom: 1px solid #1e293b; }
        #channelList {
            flex: 1;
            overflow-y: auto;
        }
        .channel {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #1e293b;
            cursor: pointer;
            transition: 0.2s;
        }
        .channel:hover { background: #1e293b; }
        .channel.active {
            background: #1e293b;
            border-left: 4px solid var(--accent);
        }
        .channel span {
            color: var(--accent);
            font-weight: bold;
            margin-right: 12px;
            min-width: 30px;
        }
        #currentName { color: var(--text-dim); font-size: 0.85rem; }

        @media(max-width: 768px) {
            #app { flex-direction: column; }
            #channels { width: 100%; height: 40vh; border-left: none; border-top: 1px solid #1e293b; }
            video { height: auto; aspect-ratio: 16/9; }
        }
    </style>
</head>

<body>
<header>
    <span>Tadio+</span>
    <span id="currentName">เลือกช่องเพื่อเริ่มรับชม...</span>
</header>

<div id="app">
    <div id="playerWrap">
        <video id="video" controls playsinline></video>
        <div class="controls">
            <button id="pipBtn" onclick="togglePIP()">PIP (จอเล็ก)</button>
            <div style="display:flex; align-items:center; gap:5px;">
                <label style="font-size:12px; color:#64748b;">คุณภาพ:</label>
                <select id="qualitySelect" onchange="changeQuality()">
                    <option value="-1">Auto</option>
                </select>
            </div>
        </div>
    </div>
    
    <div id="channels">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="ค้นหาชื่อช่องหรือเลข..." onkeyup="filterChannels()">
        </div>
        <div id="channelList"></div>
    </div>
</div>

<script>
    const PROXY = "https://iptv.tadioplus.workers.dev/?url=";

    const channels = [
        {"name":"MVTV ท้องถิ่นไทย","ch":1,"url":"https://edge2a.v2h-cdn.com/live_mvhub/mvtv75.stream/playlist.m3u8"},
        {"name":"NBT","ch":2,"url":"https://cdn-edge.iiptvcdn.com/live_event/smil:f180-054a-38d7-ce66-f7cf.smil/playlist.m3u8"},
        {"name":"TPBS","ch":3,"url":"https://thaipbs-live.cdn.byteark.com/live/playlist.m3u8"},
        {"name":"5HD","ch":5,"url":"https://639bc5877c5fe.streamlock.net/tv5hdlive/tv5hdlive/playlist.m3u8"},
        {"name":"T SPORT","ch":7,"url":"https://live-us1.thaimomo.com/live-as/chtsport-2/playlist.m3u8"},
        {"name":"MVMall Trend","ch":8,"url":"https://lb1-live-mv.v2h-cdn.com/hls/fdfe/mvmalltrend/mvmalltrend.m3u8"},
        {"name":"MVMall Plus","ch":9,"url":"https://lb1-live-mv.v2h-cdn.com/hls/fded/mvmallplus/mvmallplus.m3u8"},
        {"name":"TPTV","ch":10,"url":"https://tv-live.tpchannel.org/live/tv.m3u8"},
        {"name":"NBT North","ch":11,"url":"https://cdn-edge.iiptvcdn.com/live_event/smil:4f6e-aa34-2034-5492-c82d.smil/playlist.m3u8"},
        {"name":"NBT South","ch":12,"url":"https://cdn-edge.iiptvcdn.com/live_event/smil:a834-75a7-a662-db55-5fa3.smil/playlist.m3u8"},
        {"name":"NBT Northeast","ch":13,"url":"https://cdn-edge.iiptvcdn.com/live_event/smil:98ff-027d-46aa-1a6a-8480.smil/playlist.m3u8"},
        {"name":"NBT Central","ch":14,"url":"https://lb1-live-mv.v2h-cdn.com/hls/fddc/mvmallliving/mvmallliving.m3u8"},
        {"name":"TNN 16","ch":16,"url":"https://gmmztv.v2h-cdn.com/ffdc/gmmz-tnn16.stream/playlist.m3u8"},
        {"name":"JKN18","ch":18,"url":"http://45.144.166.242:1935//JKN/t3_jkn/playlist.m3u8"},
        {"name":"ไทบ้านทีวี","ch":21,"url":"https://edge2a.v2h-cdn.com/live_mvhub/thaiban.stream/playlist.m3u8"},
        {"name":"Nation TV","ch":22,"url":"https://lb-gmmz.sky-cdn.com/gmm/nation.m3u8"},
        {"name":"Workpoint","ch":23,"url":"https://lb-gmmz.sky-cdn.com/gmm/workpoint.m3u8"},
        {"name":"True4U","ch":24,"url":"https://lb-gmmz.sky-cdn.com/gmm/true24.m3u8"},
        {"name":"GMM25","ch":25,"url":"https://lb-gmmz.sky-cdn.com/gmm/gmm25.m3u8"},
        {"name":"MIX MAJOR","ch":26,"url":"https://edge2a.v2h-cdn.com/ttd/mix/playlist.m3u8"},
        {"name":"ช่อง 8","ch":27,"url":"https://lb-gmmz.sky-cdn.com/gmm/ch8.m3u8"},
        {"name":"MONO 29","ch":29,"url":"https://monomax-uiripn.cdn.byteark.com/plain/th/480p/index.m3u8"},
        {"name":"MCOT HD","ch":30,"url":"https://lb-gmmz.sky-cdn.com/gmm/mcot.m3u8"},
        {"name":"ONE 31","ch":31,"url":"https://lb-gmmz.sky-cdn.com/gmm/one.m3u8"},
        {"name":"Thairath TV","ch":32,"url":"http://45.144.166.242:1935//ThairathTV/t3_thairathtv/playlist.m3u8"},
        {"name":"3HD","ch":33,"url":"https://lb-gmmz.sky-cdn.com/gmm/ch3.m3u8"},
        {"name":"Amarin TV","ch":34,"url":"https://lb-gmmz.sky-cdn.com/gmm/amarin.m3u8"},
        {"name":"7HD","ch":35,"url":"https://lb-gmmz.sky-cdn.com/gmm/ch7.m3u8"},
        {"name":"PPTV HD","ch":36,"url":"https://lb-gmmz.sky-cdn.com/gmm/pptv.m3u8"},
        {"name":"Boomerang","ch":89,"url":"https://lb1-live-mv.v2h-cdn.com/partner/boom_part/boomreang.m3u8"},
        {"name":"Mango Mojito","ch":92,"url":"https://lb1-live-mv.v2h-cdn.com/partner/boom_cartoon_part/boom_catoon.m3u8"},
        {"name":"MVLAO","ch":101,"url":"https://edge2a.v2h-cdn.com/live_mvhub/mvlao.stream/playlist.m3u8"},
        {"name":"MVM","ch":102,"url":"https://edge2a.v2h-cdn.com/live_mvhub/mvm.stream/playlist.m3u8"},
        {"name":"MVCTV3","ch":103,"url":"https://edge2a.v2h-cdn.com/ttd/mvc/playlist.m3u8"},
        {"name":"France 24","ch":104,"url":"https://lb1-live-mv.v2h-cdn.com/partner/freance24_part/freance24.m3u8"},
        {"name":"CNA","ch":105,"url":"https://d2e1asnsl7br7b.cloudfront.net/7782e205e72f43aeb4a48ec97f66ebbe/index.m3u8"},
        {"name":"Esan TV","ch":106,"url":"https://edge2a.v2h-cdn.com/ttd/esan/playlist.m3u8"},
        {"name":"MV News","ch":107,"url":"https://edge2a.v2h-cdn.com/ttd/news/playlist.m3u8"},
        {"name":"TVB Thai","ch":108,"url":"https://edge2a.v2h-cdn.com/ttd/tvb/playlist.m3u8"},
        {"name":"Siam Channel","ch":109,"url":"https://edge2a.v2h-cdn.com/ttd/siam/playlist.m3u8"},
        {"name":"Lido Channel","ch":110,"url":"https://edge2a.v2h-cdn.com/ttd/lido/playlist.m3u8"},
        {"name":"Scala Channel","ch":111,"url":"https://edge2a.v2h-cdn.com/ttd/scala/playlist.m3u8"},
        {"name":"Rama Channel","ch":112,"url":"https://edge2a.v2h-cdn.com/ttd/rama/playlist.m3u8"},
        {"name":"Mutalu","ch":113,"url":"https://edge2a.v2h-cdn.com/ttd/mutalu/playlist.m3u8"},
        {"name":"MV Go Sport","ch":114,"url":"https://edge2a.v2h-cdn.com/ttd/gosport/playlist.m3u8"},
        {"name":"VTV News","ch":115,"url":"https://edge2a.v2h-cdn.com/ttd/vtvnews/playlist.m3u8"},
        {"name":"Zee Nung","ch":116,"url":"https://amg17931-zee-amg17931c4-samsung-th-5592.playouts.now.amagi.tv/playlist/amg17931-asiatvusaltdfast-zeenung-samsungth/playlist.m3u8"},
        {"name":"ThaiChaiYo","ch":117,"url":"https://live-psi.thaichaiyo.tv/tcy/live-480P.m3u8"},
        {"name":"Top TV","ch":118,"url":"https://live.cool-channel.com/cool/live-480P.m3u8"},
        {"name":"Channel 8 (Alt)","ch":119,"url":"https://cdn-th-vip.livestreaming.in.th/ch8/ch8/playlist.m3u8"},
        {"name":"GBN US","ch":120,"url":"https://us.gbnus.com/live/dhamma_high/playlist.m3u8"},
        {"name":"Boonniyom TV","ch":121,"url":"http://live.boonniyom.tv/live/bntvhd.m3u8"},
        {"name":"Police TV","ch":122,"url":"https://cdn-th-vip.livestreaming.in.th/policetv/policetv/playlist.m3u8"},
        {"name":"SBT TV","ch":123,"url":"http://122.155.12.107:1935/live/sbt_tv_aac_100/playlist.m3u8"},
        {"name":"DLTV 1","ch":201,"url":"https://cdn-live.dltv.ac.th/dltv01.m3u8"},
        {"name":"DLTV 2","ch":202,"url":"https://cdn-live.dltv.ac.th/dltv02.m3u8"},
        {"name":"DLTV 3","ch":203,"url":"https://cdn-live.dltv.ac.th/dltv03.m3u8"},
        {"name":"DLTV 4","ch":204,"url":"https://cdn-live.dltv.ac.th/dltv04.m3u8"},
        {"name":"DLTV 5","ch":205,"url":"https://cdn-live.dltv.ac.th/dltv05.m3u8"},
        {"name":"DLTV 6","ch":206,"url":"https://cdn-live.dltv.ac.th/dltv06.m3u8"},
        {"name":"DLTV 7","ch":207,"url":"https://cdn-live.dltv.ac.th/dltv07.m3u8"},
        {"name":"DLTV 8","ch":208,"url":"https://cdn-live.dltv.ac.th/dltv08.m3u8"},
        {"name":"DLTV 9","ch":209,"url":"https://cdn-live.dltv.ac.th/dltv09.m3u8"},
        {"name":"DLTV 10","ch":210,"url":"https://cdn-live.dltv.ac.th/dltv10.m3u8"},
        {"name":"DLTV 11","ch":211,"url":"https://cdn-live.dltv.ac.th/dltv11.m3u8"},
        {"name":"DLTV 12","ch":212,"url":"https://cdn-live.dltv.ac.th/dltv12.m3u8"},
        {"name":"DLTV 13","ch":213,"url":"https://cdn-live.dltv.ac.th/dltv13.m3u8"},
        {"name":"DLTV 14","ch":214,"url":"https://cdn-live.dltv.ac.th/dltv14.m3u8"},
        {"name":"DLTV 15","ch":215,"url":"https://cdn-live.dltv.ac.th/dltv15.m3u8"},
        {"name":"ETV","ch":216,"url":"http://150.95.66.20:1935/live/livestream/playlist.m3u8"}
    ].sort((a,b)=>a.ch - b.ch);

    let hls;
    const video = document.getElementById("video");
    const qualitySelect = document.getElementById("qualitySelect");
    const currentNameDisp = document.getElementById("currentName");
    const channelList = document.getElementById("channelList");

    function fixUrl(url){
        if (url.startsWith("http://") || /^(http|https):\/\/\d+\.\d+\.\d+\.\d+/.test(url)) {
            return PROXY + encodeURIComponent(url);
        }
        return url;
    }

    function play(ch, element){
        document.querySelectorAll('.channel').forEach(el => el.classList.remove('active'));
        element.classList.add('active');
        currentNameDisp.innerText = `กำลังรับชม: ${ch.name} (CH ${ch.ch})`;

        const finalUrl = fixUrl(ch.url);
        if(hls){ hls.destroy(); }

        if (Hls.isSupported()) {
            hls = new Hls({ autoStartLoad: true, startLevel: -1 });
            hls.loadSource(finalUrl);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                updateQualityMenu();
                video.play().catch(() => {});
            });
            hls.on(Hls.Events.ERROR, (event, data) => {
                if (data.fatal && finalUrl.includes(PROXY)) hls.loadSource(ch.url);
            });
        } 
        else if (video.canPlayType("application/vnd.apple.mpegurl")) {
            video.src = finalUrl;
            video.play();
        }
    }

    function updateQualityMenu() {
        qualitySelect.innerHTML = '<option value="-1">Auto</option>';
        if (hls && hls.levels) {
            hls.levels.forEach((level, index) => {
                const option = document.createElement("option");
                option.value = index;
                option.text = (level.height ? level.height + "p" : "Level " + index);
                qualitySelect.appendChild(option);
            });
        }
    }

    function changeQuality() {
        if (hls) hls.currentLevel = parseInt(qualitySelect.value);
    }

    async function togglePIP(){
        try {
            if (video !== document.pictureInPictureElement) await video.requestPictureInPicture();
            else await document.exitPictureInPicture();
        } catch (e) { alert("PIP ไม่พร้อมใช้งาน"); }
    }

    function renderChannels(data) {
        channelList.innerHTML = "";
        data.forEach(ch => {
            const div = document.createElement("div");
            div.className = "channel";
            div.innerHTML = `<span>${ch.ch}</span> ${ch.name}`;
            div.onclick = () => play(ch, div);
            channelList.appendChild(div);
        });
    }

    function filterChannels() {
        const query = document.getElementById("searchInput").value.toLowerCase();
        const filtered = channels.filter(ch => 
            ch.name.toLowerCase().includes(query) || ch.ch.toString().includes(query)
        );
        renderChannels(filtered);
    }

    // Initial Load
    renderChannels(channels);
</script>
</body>
</html>
