<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Tadio+ ‡∏î‡∏π‡∏ó‡∏µ‡∏ß‡∏µ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <link href="https://unpkg.com/@videojs/themes@1.0.1/dist/fantasy/index.css" rel="stylesheet">

    <style>
        :root { 
            --bg: #f8f9fa; 
            --panel: #ffffff; 
            --accent: #ff4757; 
            --text: #333333; 
            --border: #eeeeee;
            --hover: #fff1f2;
        }

        /* Dark Mode Settings */
        body.dark { 
            --bg: #121212; 
            --panel: #1e1e1e; 
            --accent: #ff4757; 
            --text: #eeeeee; 
            --border: #333333;
            --hover: #2d2d2d;
        }

        * { box-sizing: border-box; transition: background 0.3s, color 0.3s; }

        body { 
            margin: 0; 
            font-family: 'Kanit', sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* ‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ scroll ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
        }

        /* Header */
        header { 
            padding: 0 20px; 
            background: var(--panel); 
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border); 
            height: 60px;
            flex-shrink: 0;
        }
        .logo { font-weight: 600; font-size: 20px; color: var(--accent); }

        #home-link, #toggle-theme { 
            font-size: 13px; padding: 6px 15px; 
            border-radius: 20px; text-decoration: none; cursor: pointer; 
            border: 1px solid var(--border); background: var(--panel); color: var(--text);
        }

        /* Layout Container */
        #app { 
            display: flex; 
            flex: 1; 
            overflow: hidden; /* ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ scroll ‡πÄ‡∏≠‡∏á */
        }

        /* Player Section (Left) */
        #playerWrap { 
            flex: 1; 
            background: #000; 
            display: flex; 
            flex-direction: column; 
            position: relative;
        }
        .video-js { width: 100% !important; height: 100% !important; }

        /* Status Bar ‡πÉ‡∏ï‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô */
        .status-bar { 
            padding: 8px 15px; 
            background: rgba(0,0,0,0.8); 
            font-size: 12px; 
            color: #aaa; 
            position: absolute;
            bottom: 50px; /* ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ control bar ‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
            left: 10px;
            border-radius: 5px;
            z-index: 10;
            pointer-events: none;
        }

        /* Sidebar Section (Right) */
        #channels { 
            width: 350px; 
            background: var(--panel); 
            display: flex; 
            flex-direction: column; 
            border-left: 1px solid var(--border); 
        }

        .search-box { padding: 15px; border-bottom: 1px solid var(--border); }
        input { 
            width: 100%; padding: 10px 15px; 
            border-radius: 20px; border: 1px solid var(--border); 
            background: var(--bg); color: var(--text); outline: none; 
            font-family: 'Kanit';
        }

        /* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≠‡∏á */
        #list { 
            flex: 1; 
            overflow-y: auto; 
            padding: 10px; 
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå Scrollbar ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô */
        #list::-webkit-scrollbar { width: 6px; }
        #list::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
        body.dark #list::-webkit-scrollbar-thumb { background: #444; }

        .channel { 
            padding: 10px; 
            margin-bottom: 5px;
            border-radius: 10px;
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 12px;
            border: 2px solid transparent;
        }
        .channel:hover { background: var(--hover); }
        .channel.active { 
            background: var(--hover); 
            border-color: var(--accent);
        }

        .channel img { 
            width: 40px; height: 40px; 
            object-fit: contain; 
            background: #fff; 
            border-radius: 8px; 
            padding: 3px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .channel span { font-size: 14px; font-weight: 400; }

        /* Footer */
        footer {
            background: var(--panel);
            padding: 10px;
            text-align: center;
            border-top: 1px solid var(--border);
            font-size: 12px;
            color: #888;
            flex-shrink: 0;
        }
        footer a { color: var(--accent); text-decoration: none; }

        /* Mobile Responsive */
        @media(max-width: 850px) { 
            body { overflow-y: auto; height: auto; }
            #app { flex-direction: column; height: auto; } 
            #channels { width: 100%; border-left: none; height: 500px; }
            #playerWrap { height: 56.25vw; min-height: 250px; }
        }
    </style>
</head>
<body>

<header>
    <a href="https://teera3447.github.io/tadioplus/" id="home-link">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    <div class="logo">Tadio+ TV</div>
    <button id="toggle-theme">üåó ‡∏ò‡∏µ‡∏°</button>
</header>

<div id="app">
    <div id="playerWrap">
        <video id="my-video" class="video-js vjs-theme-fantasy" controls preload="auto" playsinline></video>
        <div class="status-bar" id="status">‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°...</div>
    </div>
    
    <div id="channels">
        <div class="search-box">
            <input type="text" id="search" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£..." oninput="filter()">
        </div>
        <div id="list">
            </div>
    </div>
</div>

<footer>
    <p>¬© 2026 <strong>Tadio+</strong> | <a href="https://forms.gle/Bh3rELNDStE91HiN8">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</a></p>
</footer>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script src="https://unpkg.com/videojs-contrib-quality-levels@4.1.0/dist/videojs-contrib-quality-levels.min.js"></script>
<script src="https://unpkg.com/videojs-hls-quality-selector@2.0.0/dist/videojs-hls-quality-selector.min.js"></script>

<script>
    // --- ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏° ---
    const themeBtn = document.getElementById('toggle-theme');
    const savedTheme = localStorage.getItem('tadio-tv-theme');
    if (savedTheme === 'dark') document.body.classList.add('dark');

    themeBtn.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        localStorage.setItem('tadio-tv-theme', document.body.classList.contains('dark') ? 'dark' : 'light');
    });

    // --- ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ñ‡∏∏‡∏ì) ---
    const BASE_WORKER_URL = "https://iptv.tadioplus.workers.dev"; 
    const GITHUB_BACKUP = "https://raw.githubusercontent.com/teera3447/tadioplus/refs/heads/main/tadio1.m3u";

    let allChannels = [];
    const statusText = document.getElementById('status');
    let v_player;

    document.addEventListener('DOMContentLoaded', () => {
        v_player = videojs('my-video', {
            fluid: false,
            responsive: true,
            autoplay: false,
            controlBar: {
                children: [
                    'playToggle',
                    'qualitySelector',
                    'liveDisplay',
                    'progressControl',
                    'volumePanel',
                    'fullscreenToggle',
                ],
            }
        });
        v_player.hlsQualitySelector({ displayCurrentQuality: true });
        loadM3U();
    });

    async function loadM3U() {
        try {
            statusText.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
            let response = await fetch(`${BASE_WORKER_URL}/list`);
            const data = await response.text();
            parseM3U(data);
        } catch (error) {
            const res = await fetch(GITHUB_BACKUP);
            const text = await res.text();
            parseM3U(text);
        }
    }

    function parseM3U(data) {
        const lines = data.split('\n');
        const channels = [];
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF:')) {
                const info = lines[i];
                const url = lines[i + 1]?.trim();
                if (url && url.startsWith('http')) {
                    const name = info.split(',')[1] || "Unknown Channel";
                    const logoMatch = info.match(/tvg-logo="([^"]+)"/);
                    const logo = logoMatch ? logoMatch[1] : "";
                    channels.push({ name, url, logo });
                }
            }
        }
        allChannels = channels;
        render(allChannels);
        statusText.innerText = `üü¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ä‡∏° ${allChannels.length} ‡∏ä‡πà‡∏≠‡∏á`;
    }

    function fixUrl(url) {
        if (url.includes('livedoomovies') || !url.startsWith('https://')) {
            return `${BASE_WORKER_URL}/?url=` + encodeURIComponent(url);
        }
        return url;
    }

    function play(ch, el) {
        const finalUrl = fixUrl(ch.url);
        document.querySelectorAll('.channel').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
        statusText.innerText = "üì° ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: " + ch.name;
        v_player.src({ src: finalUrl, type: 'application/x-mpegURL' });
        v_player.play();
    }

    function filter() {
        const txt = document.getElementById('search').value.toLowerCase();
        render(allChannels.filter(c => c.name.toLowerCase().includes(txt)));
    }

    function render(data) {
        const container = document.getElementById('list');
        container.innerHTML = "";
        data.forEach(ch => {
            const div = document.createElement('div');
            div.className = 'channel';
            const img = ch.logo ? `<img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/40x40?text=TV'">` : 'üì∫';
            div.innerHTML = `${img} <span>${ch.name}</span>`;
            div.onclick = () => play(ch, div);
            container.appendChild(div);
        });
    }
</script>
</body>
</html>
